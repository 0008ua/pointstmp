"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[650],{650:(De,O,d)=>{d.r(O),d.d(O,{GamePageModule:()=>Ee});var l=d(6019),h=d(9133),r=d(4662),b=d(4100),P=d(466),w=d(2668),p=d(8260),y=d(5305),S=d(8761),I=d(3051),q=d(7539),J=d(9204),Z=d(8717),e=d(3668),f=d(607),v=d(7871),C=d(4762);const F=function(t){return{"background-color":t}};function M(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"ion-col",2),e.NdJ("click",function(){const i=e.CHM(n).$implicit;return e.oxw().onSelect(i)}),e._UZ(1,"div",3),e.qZA()}if(2&t){const n=c.$implicit;e.xp6(1),e.Q6J("ngStyle",e.VKq(1,F,n))}}let L=(()=>{class t{constructor(n){this.popoverController=n}ngOnInit(){}dismiss(n){this.popoverController.dismiss(n)}onSelect(n){this.dismiss({color:n})}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(r.Dh))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-select-color"]],inputs:{colors:"colors"},decls:5,vars:1,consts:[[1,"select-color"],["class","select-color__container",3,"click",4,"ngFor","ngForOf"],[1,"select-color__container",3,"click"],[1,"select-color__item",3,"ngStyle"]],template:function(n,o){1&n&&(e.TgZ(0,"ion-card"),e.TgZ(1,"ion-card-content"),e.TgZ(2,"ion-grid"),e.TgZ(3,"ion-row",0),e.YNc(4,M,2,3,"ion-col",1),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(4),e.Q6J("ngForOf",o.colors))},directives:[r.PM,r.FN,r.jY,r.Nd,l.sg,r.wI,l.PC],styles:[""]}),t})();var _=d(3085);const Q=function(t){return{"background-color":t}};let k=(()=>{class t{constructor(n){this.popoverController=n,this.playersColors=p.N.games.train.playersColors,this.color=this.playersColors[0]}ngOnInit(){}presentPopover(n,o,s){return(0,C.mG)(this,void 0,void 0,function*(){const i=yield this.popoverController.create({component:o,cssClass:"select-color-popover",componentProps:s,translucent:!0});return yield i.present(),yield i.onDidDismiss()})}showSelectColorPopup(n){return(0,C.mG)(this,void 0,void 0,function*(){const{data:o}=yield this.presentPopover(n,L,{colors:this.playersColors});if(o){const{color:s}=o;this.color=s}})}dismiss(n){this.popoverController.dismiss(n)}onCreate(){this.dismiss({gamer:{color:this.color,name:this.name}})}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(r.Dh))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-create-gamer"]],decls:26,vars:17,consts:[["slot","end"],[3,"click"],["lines","none"],[1,"players-list"],[1,"players-list__color"],[1,"select-color",3,"ngStyle","click"],[1,"players-list__info"],["clearInput","",3,"placeholder","ngModel","ngModelChange"],["expand","block",3,"disabled","click"]],template:function(n,o){1&n&&(e.TgZ(0,"ion-header"),e.TgZ(1,"ion-toolbar"),e.TgZ(2,"ion-title"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"ion-buttons",0),e.TgZ(6,"ion-button",1),e.NdJ("click",function(){return o.dismiss()}),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"ion-content"),e.TgZ(10,"ion-card"),e.TgZ(11,"ion-card-content"),e.TgZ(12,"ion-list"),e.TgZ(13,"ion-item",2),e.TgZ(14,"div",3),e.TgZ(15,"div",4),e.TgZ(16,"div",5),e.NdJ("click",function(i){return o.showSelectColorPopup(i)}),e.qZA(),e.qZA(),e.TgZ(17,"div",6),e.TgZ(18,"ion-item"),e.TgZ(19,"ion-input",7),e.NdJ("ngModelChange",function(i){return o.name=i}),e.ALo(20,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(21,"ion-row"),e.TgZ(22,"ion-col"),e.TgZ(23,"ion-button",8),e.NdJ("click",function(){return o.onCreate()}),e._uU(24),e.ALo(25,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(3),e.Oqu(e.lcZ(4,7,"modules.games.createGamer")),e.xp6(4),e.hij(" ",e.lcZ(8,9,"elements.button.close")," "),e.xp6(9),e.Q6J("ngStyle",e.VKq(15,Q,o.color)),e.xp6(3),e.Q6J("placeholder",e.lcZ(20,11,"modules.user.name"))("ngModel",o.name),e.xp6(4),e.Q6J("disabled",!o.name),e.xp6(1),e.hij(" ",e.lcZ(25,13,"elements.button.create")," "))},directives:[r.Gu,r.sr,r.wd,r.Sm,r.YG,r.W2,r.PM,r.FN,r.q_,r.Ie,l.PC,r.pK,r.j9,h.JJ,h.On,r.Nd,r.wI],pipes:[_.X$],styles:[""]}),t})();var x=d(5803),G=d(9973);function U(t,c){if(1&t&&(e.TgZ(0,"ion-select-option",15),e._uU(1),e.qZA()),2&t){const n=c.$implicit;e.Q6J("value",n),e.xp6(1),e.hij(" ",n.name," ")}}const Y=function(t){return{"background-color":t}};function j(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"ion-item-sliding",9),e.TgZ(1,"ion-item",9),e.TgZ(2,"div",10),e.TgZ(3,"div",11),e.TgZ(4,"div",12),e.NdJ("click",function(s){const a=e.CHM(n).index,u=e.oxw();return u.filtredColors.length>1?u.showSelectColorPopup(s,a):null}),e.qZA(),e.qZA(),e.TgZ(5,"div",13),e.TgZ(6,"ion-item"),e.TgZ(7,"ion-select",14),e.NdJ("ionChange",function(s){const a=e.CHM(n).index;return e.oxw().choosePlayerHandler(s,a)}),e.TgZ(8,"ion-select-option",15),e._uU(9),e.qZA(),e.YNc(10,U,2,2,"ion-select-option",16),e.qZA(),e.TgZ(11,"ion-note",17),e._UZ(12,"ion-icon",18),e._UZ(13,"ion-icon",19),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"ion-item-options",20),e.TgZ(15,"ion-item-option",21),e.NdJ("click",function(){const i=e.CHM(n).$implicit;return e.oxw().removePlayerHandler(i._id)}),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.qZA(),e.qZA()}if(2&t){const n=c.$implicit,o=e.oxw();e.xp6(4),e.Q6J("ngStyle",e.VKq(8,Y,null==n?null:n.color)),e.xp6(3),e.Q6J("value",n),e.xp6(1),e.Q6J("value",n),e.xp6(1),e.hij(" ",n.name," "),e.xp6(1),e.Q6J("ngForOf",o.filtredGamers),e.xp6(6),e.Oqu(e.lcZ(17,6,"elements.button.remove"))}}let B=(()=>{class t{constructor(n,o,s,i,a,u){this.store=n,this.translate=o,this.gamerService=s,this.popoverController=i,this.alertController=a,this.sharedService=u,this.environment=p.N,this.gamers=[],this.filtredGamers=[],this.players=[]}ngOnInit(){this.gameType$=this.store.select(y.Wn),this.gameType$.subscribe(n=>{var o,s;this.gameType=n,this.playersColors=null===(o=p.N.games[n])||void 0===o?void 0:o.playersColors,this.filtredColors=null===(s=p.N.games[n])||void 0===s?void 0:s.playersColors}),this.players$=this.store.select(I.y1),this.players$.subscribe(n=>{this.players=n,this.filter()}),this.gamers$=this.gamerService.entities$,this.gamers$.subscribe(n=>{this.gamers=n,this.filter()})}startGameHandler(){this.store.dispatch(Z.Uk())}presentPopover(n,o,s){return(0,C.mG)(this,void 0,void 0,function*(){const i=yield this.popoverController.create({component:o,cssClass:"select-color-popover",componentProps:s,translucent:!0});return yield i.present(),yield i.onDidDismiss()})}showSelectColorPopup(n,o){return(0,C.mG)(this,void 0,void 0,function*(){const{data:s}=yield this.presentPopover(n,L,{colors:this.filtredColors});if(s){const{color:i}=s;this.chooseColorHandler(i,o)}})}showCreateGamerPopup(n){return(0,C.mG)(this,void 0,void 0,function*(){const{data:o}=yield this.presentPopover(n,k,null);if(o){const{gamer:s}=o;this.createGamerHandler(s)}})}filter(){var n;this.filtredGamers=this.gamers.filter(s=>{for(const i of this.players)if(i._id===s._id)return!1;return!0});const o=null===(n=this.playersColors)||void 0===n?void 0:n.filter((s,i)=>{for(const a of this.players)if(a.color===s)return!1;return!0});this.filtredColors=(null==o?void 0:o.length)?o:this.filtredColors}choosePlayerHandler(n,o){const s=this.players.map((i,a)=>a===o?this.filtredColors.includes(this.filtredGamers[0].color)?n.target.value:Object.assign(Object.assign({},n.target.value),{color:this.filtredColors[0]}):i);this.store.dispatch(x.K9({players:s}))}chooseColorHandler(n,o){this.players=this.players.map((s,i)=>i===o?Object.assign(Object.assign({},s),{color:n}):s),this.filter()}removePlayerHandler(n){this.store.dispatch(x.WQ({id:n}))}removeAllPlayersHandler(){this.store.dispatch(x.dO())}addPlayerHandler(n=!0){if(!this.filtredGamers.length)return;let o=this.filtredGamers[0];n||(o=this.filtredGamers[this.filtredGamers.length-1]),this.filtredColors.includes(o.color)?this.store.dispatch(x.KM({player:Object.assign({},o)})):this.store.dispatch(x.KM({player:Object.assign(Object.assign({},o),{color:this.filtredColors[0]})}))}createGamerHandler(n){this.gamerService.add(n).subscribe(o=>{})}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(f.yh),e.Y36(_.sK),e.Y36(G.E),e.Y36(r.Dh),e.Y36(r.Br),e.Y36(v.F))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-choose-players"]],decls:30,vars:23,consts:[[1,"ion-text-center"],[1,"choose-players"],[1,"choose-players__list"],["lines","none",4,"ngFor","ngForOf"],[1,"choose-players__btn-block"],["expand","block","fill","outline","size","small","color","secondary",3,"disabled","click"],["expand","block","fill","outline","size","small","color","success",3,"click"],["expand","block","fill","outline","size","small","color","danger",3,"click"],["expand","block",3,"disabled","click"],["lines","none"],[1,"players-list"],[1,"players-list__color"],[1,"select-color",3,"ngStyle","click"],[1,"players-list__info"],["placeholder","Select One","interface","popover","slot","end",3,"value","ionChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["slot","end","color","danger"],["name","trash-outline"],["name","caret-back-outline"],["side","end"],["color","danger",3,"click"]],template:function(n,o){1&n&&(e.TgZ(0,"ion-card"),e.TgZ(1,"ion-card-header"),e.TgZ(2,"ion-card-title",0),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"ion-card-subtitle",0),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.qZA(),e.TgZ(8,"ion-card-content",1),e.TgZ(9,"ion-list",2),e.YNc(10,j,18,10,"ion-item-sliding",3),e.ALo(11,"async"),e.qZA(),e.TgZ(12,"ion-row",4),e.TgZ(13,"ion-col"),e.TgZ(14,"ion-button",5),e.NdJ("click",function(){return o.addPlayerHandler()}),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.qZA(),e.TgZ(17,"ion-col"),e.TgZ(18,"ion-button",6),e.NdJ("click",function(i){return o.showCreateGamerPopup(i)}),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.qZA(),e.TgZ(21,"ion-col"),e.TgZ(22,"ion-button",7),e.NdJ("click",function(){return o.removeAllPlayersHandler()}),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(25,"ion-row",4),e.TgZ(26,"ion-col"),e.TgZ(27,"ion-button",8),e.NdJ("click",function(){return o.startGameHandler()}),e._uU(28),e.ALo(29,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(3),e.Oqu(e.lcZ(4,9,"modules.games.addPlayers")),e.xp6(3),e.Oqu(e.lcZ(7,11,"games."+o.gameType+".title")),e.xp6(4),e.Q6J("ngForOf",e.lcZ(11,13,o.players$)),e.xp6(4),e.Q6J("disabled",o.players.length>=(null==o.environment.games[o.gameType]?null:o.environment.games[o.gameType].maxPlayersQty)),e.xp6(1),e.hij(" ",e.lcZ(16,15,"elements.button.add")," "),e.xp6(4),e.hij(" ",e.lcZ(20,17,"elements.button.create")," "),e.xp6(4),e.hij(" ",e.lcZ(24,19,"elements.button.removeAll")," "),e.xp6(4),e.Q6J("disabled",o.players.length<2||o.players.length>(null==o.environment.games[o.gameType]?null:o.environment.games[o.gameType].maxPlayersQty)),e.xp6(1),e.hij(" ",e.lcZ(29,21,"elements.button.startGame")," "))},directives:[r.PM,r.Zi,r.Dq,r.tO,r.FN,r.q_,l.sg,r.Nd,r.wI,r.YG,r.td,r.Ie,l.PC,r.t9,r.QI,r.n0,r.uN,r.gu,r.IK,r.u8],pipes:[_.X$,l.Ov],styles:[""]}),t})();const g=new e.OlP("roundComponent");function H(t,c){if(1&t&&(e.TgZ(0,"span",6),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"async"),e.qZA()),2&t){const n=e.oxw();let o;e.xp6(1),e.AsE(" ",e.lcZ(2,2,"games."+e.lcZ(3,4,n.gameType$)+"."+(null==(o=n.getRoundById())?null:o.name))," ",null==(o=n.getRoundById())?null:o.namePostfix," ")}}const z=function(t){return{"border-bottom":t}},E=["*"];let D=(()=>{class t{constructor(n,o){this.sharedService=n,this.store=o}ngOnInit(){this.loading$=this.store.select(y.NH),this.gameType$=this.store.select(y.Wn),this.gameType$.subscribe(n=>this.gameType=n)}getRoundById(){return this.sharedService.getRoundById(this.roundId)}calcScores(){var n;return null===(n=this.getMemberByPlayerId())||void 0===n?void 0:n.scoresLine.reduce((o,s)=>o+s,0)}getPlayerColor(){return this.sharedService.getPlayerColor(this.playerId)}getPlayerName(){return this.sharedService.getPlayerName(this.playerId)}getMemberByPlayerId(){return this.sharedService.getMemberByPlayerId(this.playerId,this.roundId)}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(v.F),e.Y36(f.yh))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-round-wrapper"]],contentQueries:function(n,o,s){if(1&n&&e.Suo(s,g,7),2&n){let i;e.iGM(i=e.CRH())&&(o.roundComponent=i.first)}},inputs:{playerId:"playerId",roundId:"roundId"},ngContentSelectors:E,decls:13,vars:9,consts:[[3,"ngStyle"],[1,"round-subtitle"],["color","primary",1,"round-subtitle__icon",3,"name"],["class","ion-text-capitalize round-subtitle__text",4,"ngIf"],[1,"round-subtitle__blank"],[1,"ion-text-center"],[1,"ion-text-capitalize","round-subtitle__text"]],template:function(n,o){if(1&n&&(e.F$t(),e.TgZ(0,"ion-card"),e.TgZ(1,"ion-card-header",0),e.TgZ(2,"ion-card-subtitle"),e.TgZ(3,"span",1),e._UZ(4,"ion-icon",2),e.YNc(5,H,4,6,"span",3),e.ALo(6,"async"),e._UZ(7,"span",4),e.TgZ(8,"span"),e._uU(9),e.qZA(),e.qZA(),e.qZA(),e.TgZ(10,"ion-card-title",5),e._uU(11),e.qZA(),e.qZA(),e.Hsn(12),e.qZA()),2&n){let s;e.xp6(1),e.Q6J("ngStyle",e.VKq(7,z,"2px solid "+o.getPlayerColor())),e.xp6(3),e.Q6J("name",null==(s=o.getRoundById())?null:s.icon),e.xp6(1),e.Q6J("ngIf","rummy"!==e.lcZ(6,5,o.gameType$)),e.xp6(4),e.Oqu(o.calcScores()),e.xp6(2),e.Oqu(o.getPlayerName())}},directives:[r.PM,r.Zi,l.PC,r.tO,r.gu,l.O5,r.Dq],pipes:[l.Ov,_.X$],styles:[""]}),t})();var $=d(1410),W=d(739),T=d(8775),X=d(153);let K=(()=>{class t{constructor(n,o,s){this.store=n,this.sharedService=o,this.telegramService=s}storeRoundScores(n){const o=[];for(const s in n)n.hasOwnProperty(s)&&this.store.select((0,q.Lz)(s)).pipe((0,W.P)()).subscribe(i=>{const a={name:n[s].name,value:n[s].value};o.push({id:i._id,changes:Object.assign(Object.assign({},i),{namedScoresLine:[...i.namedScoresLine,a],scoresLine:[...i.scoresLine,a.value]})})});this.store.dispatch(T.Dy({roundMembers:o}))}addToNamedScoresLine(n,o,s){const i=this.sharedService.getMemberByPlayerId(o,s),a=Object.assign(Object.assign({},i),{namedScoresLine:[...i.namedScoresLine,n],scoresLine:[...i.scoresLine,n.value]});this.store.dispatch(T.hx({roundMember:{id:i._id,changes:a}}))}addToScoresLine(n,o,s){const i=this.sharedService.getMemberByPlayerId(o,s),a=Object.assign(Object.assign({},i),{scoresLine:[...i.scoresLine,n]});this.store.dispatch(T.hx({roundMember:{id:i._id,changes:a}}))}removeFromNamedScoresLine(n,o,s){const i=this.sharedService.getMemberByPlayerId(o,s),a=[...i.namedScoresLine],u=a.findIndex(m=>m.name===n.name);if(-1!==u){a.splice(u,1);const m=Object.assign(Object.assign({},i),{namedScoresLine:a});this.store.dispatch(T.hx({roundMember:{id:i._id,changes:m}})),this.removeFromScoresLine(n.value,o,s)}}removeFromScoresLine(n,o,s){const i=this.sharedService.getMemberByPlayerId(o,s),a=[...i.scoresLine],u=a.indexOf(n);a.splice(u,1);const m=Object.assign(Object.assign({},i),{scoresLine:a});this.store.dispatch(T.hx({roundMember:{id:i._id,changes:m}}))}setScoresLine(n,o,s){const i=this.sharedService.getMemberByPlayerId(o,s),a=Object.assign(Object.assign({},i),{scoresLine:n});this.store.dispatch(T.hx({roundMember:{id:i._id,changes:a}}))}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(f.yh),e.LFG(v.F),e.LFG(X.J))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),R=(()=>{class t{constructor(n){this.sharedService=n.get(v.F),this.gamesService=n.get(K),this.actions$=n.get($.eX)}getMemberByPlayerId(){return this.sharedService.getMemberByPlayerId(this.playerId,this.roundId)}addToScoresLine(n){this.gamesService.addToScoresLine(n,this.playerId,this.roundId)}removeFromScoresLine(n){this.gamesService.removeFromScoresLine(n,this.playerId,this.roundId)}setScoresLine(n,o,s){this.gamesService.setScoresLine(n,o,s)}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(e.zs3))},t.\u0275dir=e.lG2({type:t,selectors:[["","appRound",""]],inputs:{playerId:"playerId",roundId:"roundId"}}),t})(),A=(()=>{class t extends R{constructor(n){super(n)}addToNamedScoresLine(n,o){this.gamesService.addToNamedScoresLine(n,o||this.playerId,this.roundId)}removeFromNamedScoresLine(n){this.gamesService.removeFromNamedScoresLine(n,this.playerId,this.roundId)}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(e.zs3))},t.\u0275dir=e.lG2({type:t,selectors:[["","appRoundScoresLine",""]],features:[e.qOj]}),t})(),V=(()=>{class t extends A{constructor(n){super(n),this.store=n.get(f.yh),this.rounds$=this.store.select(S.PK),this.roundMembers$=this.store.select(q.uW)}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(e.zs3))},t.\u0275dir=e.lG2({type:t,selectors:[["","appRoundT",""]],features:[e.qOj]}),t})();function ee(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"ion-col",2),e.TgZ(1,"ion-chip",3),e.NdJ("click",function(){const i=e.CHM(n).$implicit,a=e.oxw();return a.addToNamedScoresLine({value:i.value*a.inverse,name:a.numberFn(i.name)*a.inverse+""})}),e.TgZ(2,"ion-label"),e._uU(3),e.qZA(),e.qZA(),e.qZA()}if(2&t){const n=c.$implicit,o=e.oxw();e.xp6(1),e.Q6J("color",n.value>19?"secondary":"warning"),e.xp6(2),e.Oqu(n.value*o.inverse)}}function ne(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"ion-col",2),e.TgZ(1,"ion-chip",7),e.NdJ("click",function(){const i=e.CHM(n).$implicit;return e.oxw().removeFromNamedScoresLine({value:i.value,name:i.name})}),e.TgZ(2,"ion-label"),e._uU(3),e.qZA(),e._UZ(4,"ion-icon",8),e.qZA(),e.qZA()}if(2&t){const n=c.$implicit;e.xp6(1),e.Q6J("color",n.value>19?"secondary":n.value<0?"danger":"warning"),e.xp6(2),e.Oqu(n.value)}}let oe=(()=>{class t extends A{constructor(n){super(n),this.routesScoresEnv=p.N.games.train.routesScores,this.inverse=1,this.numberFn=Number}ngOnInit(){}inverseScore(){this.inverse=-1*this.inverse}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(e.zs3))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-round-routes"]],inputs:{playerId:"playerId",roundId:"roundId"},features:[e._Bn([{provide:g,useExisting:t}]),e.qOj],decls:9,vars:3,consts:[[1,"round","round_tools"],["size","3",4,"ngFor","ngForOf"],["size","3"],[3,"color","click"],["name","add-outline"],["name","remove-outline"],[1,"round","round_result"],["outline","",3,"color","click"],["name","close-circle"]],template:function(n,o){1&n&&(e.TgZ(0,"ion-card-content"),e.TgZ(1,"ion-row",0),e.YNc(2,ee,4,2,"ion-col",1),e.TgZ(3,"ion-col",2),e.TgZ(4,"ion-chip",3),e.NdJ("click",function(){return o.inverseScore()}),e._UZ(5,"ion-icon",4),e._UZ(6,"ion-icon",5),e.qZA(),e.qZA(),e.qZA(),e.TgZ(7,"ion-row",6),e.YNc(8,ne,5,2,"ion-col",1),e.qZA(),e.qZA()),2&n&&(e.xp6(2),e.Q6J("ngForOf",o.routesScoresEnv),e.xp6(2),e.Q6J("color","danger"),e.xp6(4),e.Q6J("ngForOf",o.getMemberByPlayerId().namedScoresLine))},directives:[r.FN,r.Nd,l.sg,r.wI,r.hM,r.gu,r.Q$],styles:[""]}),t})(),te=(()=>{class t extends R{constructor(n){super(n),this.longestRouteScoreEnv=p.N.games.train.longestRouteScore}ngOnInit(){}onMarkLongestHandler(n){this.setScoresLine(n.target.checked?[this.longestRouteScoreEnv]:[],this.playerId,this.roundId)}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(e.zs3))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-round-length"]],features:[e._Bn([{provide:g,useExisting:t}]),e.qOj],decls:7,vars:4,consts:[[1,"round","round_tools"],[3,"checked","ionChange"]],template:function(n,o){if(1&n&&(e.TgZ(0,"ion-card-content"),e.TgZ(1,"ion-row"),e.TgZ(2,"ion-col",0),e.TgZ(3,"div"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"ion-toggle",1),e.NdJ("ionChange",function(i){return o.onMarkLongestHandler(i)}),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n){let s;e.xp6(4),e.Oqu(e.lcZ(5,2,"games.train.longestRoute")),e.xp6(2),e.Q6J("checked",null==(s=o.getMemberByPlayerId())?null:s.scoresLine.length)}},directives:[r.FN,r.Nd,r.wI,r.ho,r.w],pipes:[_.X$],styles:[""]}),t})(),se=(()=>{class t extends R{constructor(n){super(n)}ngOnInit(){}calcScores(){return this.getMemberByPlayerId().scoresLine.reduce((n,o)=>n+o,0)}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(e.zs3))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-round-stations"]],features:[e._Bn([{provide:g,useExisting:t}]),e.qOj],decls:15,vars:6,consts:[[1,"round","round_tools"],[1,"round_tools__score"],[1,"round_tools__btn"],[1,"incDecBtn"],["shape","round","color","danger","fill","outline",3,"disabled","click"],["name","remove-outline"],[1,"incDecBtn__caption"],["shape","round","color","success","fill","outline",3,"disabled","click"],["name","add-outline"]],template:function(n,o){1&n&&(e.TgZ(0,"ion-card-content"),e.TgZ(1,"ion-row",0),e.TgZ(2,"ion-col",1),e.TgZ(3,"ion-label"),e._uU(4),e.qZA(),e.qZA(),e.TgZ(5,"ion-col",2),e.TgZ(6,"div",3),e.TgZ(7,"ion-button",4),e.NdJ("click",function(){return o.addToScoresLine(4)}),e._UZ(8,"ion-icon",5),e.qZA(),e.TgZ(9,"span",6),e.TgZ(10,"div"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.qZA(),e.TgZ(13,"ion-button",7),e.NdJ("click",function(){return o.removeFromScoresLine(4)}),e._UZ(14,"ion-icon",8),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.xp6(4),e.Oqu(3-o.calcScores()/4),e.xp6(3),e.Q6J("disabled",o.getMemberByPlayerId().scoresLine.length>=3),e.xp6(4),e.Oqu(e.lcZ(12,4,"games.train.stationsShort")),e.xp6(2),e.Q6J("disabled",o.getMemberByPlayerId().scoresLine.length<=0))},directives:[r.FN,r.Nd,r.wI,r.Q$,r.YG,r.gu],pipes:[_.X$],styles:[""]}),t})();function re(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"ion-row",1),e.TgZ(1,"ion-col",2),e.TgZ(2,"ion-label"),e._uU(3),e.qZA(),e.qZA(),e.TgZ(4,"ion-col",3),e.TgZ(5,"div",4),e.TgZ(6,"ion-button",5),e.NdJ("click",function(){const i=e.CHM(n).$implicit;return e.oxw().removeFromScoresLine(i.value)}),e._UZ(7,"ion-icon",6),e.qZA(),e.TgZ(8,"span",7),e._UZ(9,"ion-icon",8),e._uU(10),e.qZA(),e.TgZ(11,"ion-button",9),e.NdJ("click",function(){const i=e.CHM(n).$implicit;return e.oxw().addToScoresLine(i.value)}),e._UZ(12,"ion-icon",10),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&t){const n=c.$implicit,o=e.oxw();e.xp6(3),e.Oqu(o.calcQtyOfArrItems(n.value)),e.xp6(7),e.hij(" ",n.name," ")}}let ie=(()=>{class t extends A{constructor(n){super(n),this.carsScoresEnv=p.N.games.train.carsScores}ngOnInit(){}calcQtyOfArrItems(n){return this.sharedService.calcQtyOfArrItems(n,this.playerId,this.roundId)}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(e.zs3))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-round-cars"]],features:[e._Bn([{provide:g,useExisting:t}]),e.qOj],decls:2,vars:1,consts:[["class","round round_tools",4,"ngFor","ngForOf"],[1,"round","round_tools"],[1,"round_tools__score"],[1,"round_tools__btn"],[1,"incDecBtn"],["shape","round","color","danger","fill","outline",3,"click"],["name","remove-outline"],[1,"incDecBtn__caption"],["name","train-outline"],["shape","round","color","success","fill","outline",3,"click"],["name","add-outline"]],template:function(n,o){1&n&&(e.TgZ(0,"ion-card-content"),e.YNc(1,re,13,2,"ion-row",0),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngForOf",o.carsScoresEnv))},directives:[r.FN,l.sg,r.Nd,r.wI,r.Q$,r.YG,r.gu],styles:[""]}),t})();function ce(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"ion-col",4),e.TgZ(1,"img",5),e.NdJ("click",function(){const i=e.CHM(n).$implicit;return e.oxw().addToNamedScoresLine(i)}),e.qZA(),e.qZA()}if(2&t){const n=c.$implicit;e.xp6(1),e.Q6J("src",n.picture,e.LSH)("alt",n.name)}}function ae(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"ion-col",6),e.TgZ(1,"img",7),e.NdJ("click",function(){const i=e.CHM(n).$implicit;return e.oxw().removeFromNamedScoresLine(i)}),e.qZA(),e.qZA()}if(2&t){const n=c.$implicit;e.xp6(1),e.Q6J("src",n.picture,e.LSH)("alt",n.name)}}let le=(()=>{class t extends A{constructor(n){super(n),this.namedScoresEnv=p.N.games.uno.namedScores,this.namedScoreLine=[]}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(e.zs3))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-round-uno"]],features:[e._Bn([{provide:g,useExisting:t}]),e.qOj],decls:5,vars:2,consts:[[1,"round","round_tools"],["size","2.4",4,"ngFor","ngForOf"],[1,"round","round_result"],["size","1",4,"ngFor","ngForOf"],["size","2.4"],[1,"uno-round-img",3,"src","alt","click"],["size","1"],[3,"src","alt","click"]],template:function(n,o){if(1&n&&(e.TgZ(0,"ion-card-content"),e.TgZ(1,"ion-row",0),e.YNc(2,ce,2,2,"ion-col",1),e.qZA(),e.TgZ(3,"ion-row",2),e.YNc(4,ae,2,2,"ion-col",3),e.qZA(),e.qZA()),2&n){let s;e.xp6(2),e.Q6J("ngForOf",o.namedScoresEnv),e.xp6(2),e.Q6J("ngForOf",null==(s=o.getMemberByPlayerId())?null:s.namedScoresLine)}},directives:[r.FN,r.Nd,l.sg,r.wI],styles:[""]}),t})();function de(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"ion-col",4),e.TgZ(1,"ion-chip",5),e.NdJ("click",function(){const i=e.CHM(n).$implicit;return e.oxw().addToNamedScoresLine(i)}),e.TgZ(2,"ion-label"),e._uU(3),e.qZA(),e.qZA(),e.qZA()}if(2&t){const n=c.$implicit;e.xp6(3),e.Oqu(n.name)}}function ue(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"ion-col",6),e.TgZ(1,"ion-chip",7),e.NdJ("click",function(){const i=e.CHM(n).$implicit;return e.oxw().removeFromNamedScoresLine(i)}),e.TgZ(2,"ion-label"),e._uU(3),e.qZA(),e._UZ(4,"ion-icon",8),e.qZA(),e.qZA()}if(2&t){const n=c.$implicit;e.xp6(1),e.Q6J("color","secondary"),e.xp6(2),e.Oqu(n.name)}}let pe=(()=>{class t extends A{constructor(n){super(n),this.namedScoresEnv=p.N.games.rummy.namedScores,this.namedScoreLine=[]}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(e.zs3))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-round-rummy"]],features:[e._Bn([{provide:g,useExisting:t}]),e.qOj],decls:5,vars:2,consts:[[1,"round","round_tools"],["size","2.4",4,"ngFor","ngForOf"],[1,"round","round_result"],["size","1",4,"ngFor","ngForOf"],["size","2.4"],[3,"click"],["size","1"],["outline","",3,"color","click"],["name","close-circle"]],template:function(n,o){if(1&n&&(e.TgZ(0,"ion-card-content"),e.TgZ(1,"ion-row",0),e.YNc(2,de,4,1,"ion-col",1),e.qZA(),e.TgZ(3,"ion-row",2),e.YNc(4,ue,5,2,"ion-col",3),e.qZA(),e.qZA()),2&n){let s;e.xp6(2),e.Q6J("ngForOf",o.namedScoresEnv),e.xp6(2),e.Q6J("ngForOf",null==(s=o.getMemberByPlayerId())?null:s.namedScoresLine)}},directives:[r.FN,r.Nd,l.sg,r.wI,r.hM,r.Q$,r.gu],styles:[""]}),t})();function me(t,c){if(1&t&&(e.TgZ(0,"ion-col"),e.TgZ(1,"ion-text"),e._uU(2),e.qZA(),e.qZA()),2&t){const n=c.$implicit;e.xp6(2),e.Oqu(n.name)}}const _e=function(t){return{"border-bottom":t}},ge=["*"];let he=(()=>{class t{constructor(n,o){this.sharedService=n,this.store=o}ngOnInit(){this.loading$=this.store.select(y.NH),this.gameType$=this.store.select(y.Wn),this.players$=this.store.select(I.y1),this.gameType$.subscribe(n=>this.gameType=n)}getRoundById(){return this.sharedService.getRoundById(this.roundId)}calcScores(){var n;return null===(n=this.getMemberByPlayerId())||void 0===n?void 0:n.scoresLine.reduce((o,s)=>o+s,0)}getPlayerColor(){return this.sharedService.getPlayerColor(this.playerId)}getPlayerName(){return this.sharedService.getPlayerName(this.playerId)}getMemberByPlayerId(){return this.sharedService.getMemberByPlayerId(this.playerId,this.roundId)}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(v.F),e.Y36(f.yh))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-round-t-wrapper"]],contentQueries:function(n,o,s){if(1&n&&e.Suo(s,g,7),2&n){let i;e.iGM(i=e.CRH())&&(o.roundComponent=i.first)}},inputs:{playerId:"playerId",roundId:"roundId"},ngContentSelectors:ge,decls:7,vars:6,consts:[[3,"ngStyle"],[1,"ion-text-center"],[4,"ngFor","ngForOf"]],template:function(n,o){1&n&&(e.F$t(),e.TgZ(0,"ion-card"),e.TgZ(1,"ion-card-header",0),e.TgZ(2,"ion-card-title",1),e.TgZ(3,"ion-row"),e.YNc(4,me,3,1,"ion-col",2),e.ALo(5,"async"),e.qZA(),e.qZA(),e.qZA(),e.Hsn(6),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngStyle",e.VKq(4,_e,"2px solid "+o.getPlayerColor())),e.xp6(3),e.Q6J("ngForOf",e.lcZ(5,2,o.players$)))},directives:[r.PM,r.Zi,l.PC,r.Dq,r.Nd,l.sg,r.wI,r.yW],pipes:[l.Ov],styles:[""]}),t})();const ye=function(){return{"active-item":!0}},fe=function(){return{"regular-item":!0}};function Ze(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"ion-col",4),e._UZ(1,"div",5),e.TgZ(2,"div",6),e.TgZ(3,"ion-button",7),e.NdJ("click",function(){const i=e.CHM(n).$implicit;return e.oxw().changeScoresState(i._id,"r")}),e._uU(4,"R"),e.qZA(),e.TgZ(5,"ion-button",7),e.NdJ("click",function(){const i=e.CHM(n).$implicit;return e.oxw().changeScoresState(i._id,"s")}),e._uU(6,"S"),e.qZA(),e.qZA(),e.TgZ(7,"ion-item",8),e.TgZ(8,"ion-input",9),e.NdJ("ngModelChange",function(s){const a=e.CHM(n).$implicit;return e.oxw().scores[a._id].value=s}),e.qZA(),e.qZA(),e.qZA()}if(2&t){const n=c.$implicit,o=e.oxw();e.Q6J("size",12/o.qtyOfPlayers),e.xp6(1),e.Q6J("ngClass",n._id===o.activeRoundMemberId?e.DdM(7,ye):e.DdM(8,fe)),e.xp6(2),e.Q6J("fill","r"!==(null==o.scores[n._id]?null:o.scores[n._id].name)?"solid":"outline")("disabled",(null==o.scores[n._id]?null:o.scores[n._id].disabled.includes("r"))||o.scores[n._id].barrel>0||n._id===o.activeRoundMemberId&&4===o.qtyOfPlayers),e.xp6(2),e.Q6J("fill","s"!==(null==o.scores[n._id]?null:o.scores[n._id].name)?"solid":"outline")("disabled",(null==o.scores[n._id]?null:o.scores[n._id].disabled.includes("s"))||o.scores[n._id].barrel>0||n._id===o.activeRoundMemberId&&4===o.qtyOfPlayers),e.xp6(3),e.Q6J("ngModel",o.scores[n._id].value)}}const ve=function(t){return{"thousand-score__total_last":t}};function Te(t,c){if(1&t&&(e.TgZ(0,"ion-item",11),e.TgZ(1,"ion-text",12),e._uU(2),e.qZA(),e._UZ(3,"div",13),e.TgZ(4,"ion-text",14),e._uU(5),e.qZA(),e.qZA()),2&t){const n=c.$implicit,o=c.index,s=e.oxw().$implicit,i=e.oxw();e.Q6J("lines",(s.namedScoresLine.length-o-1)%i.qtyOfPlayers==0?"full":"none"),e.xp6(1),e.Q6J("color",o<=1&&i.scores[s._id].doubleZero?"danger":""),e.xp6(1),e.Oqu("r"===n.name||"s"===n.name?n.name.toUpperCase():n.value),e.xp6(2),e.Q6J("ngClass",e.VKq(6,ve,0===o))("color",n.total>=900&&n.total<1e3&&i.scores[s._id].barrel&&o<i.qtyOfPlayers?"danger":""),e.xp6(1),e.Oqu(n.total)}}function Ce(t,c){if(1&t&&(e.TgZ(0,"ion-col",4),e.YNc(1,Te,6,8,"ion-item",10),e.qZA()),2&t){const n=c.$implicit,o=e.oxw();e.Q6J("size",12/o.qtyOfPlayers),e.xp6(1),e.Q6J("ngForOf",n.namedScoresLine.slice().reverse())}}let xe=(()=>{class t extends V{constructor(n){super(n),this.scores={},this.initialScores={},this.isFinished=!1}ngOnInit(){this.roundMembers$.subscribe(n=>{if(this.qtyOfPlayers=n.length,this.roundMembers=n,this.checkOnFinishGame()&&!this.isFinished)return this.isFinished=!0,this.store.dispatch(Z.M8());this.roundMembers.length&&this.resetScores()}),this.actions$.pipe((0,$.l4)(Z.GJ)).subscribe(n=>this.scores={})}addTotals(n){return n.map(o=>{let s=0;return Object.assign(Object.assign({},o),{namedScoresLine:o.namedScoresLine.map(i=>(s=i.value+s,Object.assign(Object.assign({},i),{total:s})))})})}changeScoresState(n,o){if(this.scores[n].barrel>0)return;const s=this.scores[n];if(this.roundScoresOption=o,!s.disabled.includes(o)){if(s.name===o)return void(this.scores=JSON.parse(JSON.stringify(this.initialScores)));this.scores[n].name=o,this.scores[n].value="r"===o?0:-100,Object.keys(this.scores).filter(i=>i!==n).forEach(i=>{this.scores[i]=Object.assign(Object.assign({},this.initialScores[i]),{value:"r"===o?60:0})})}}resetScores(){const n=this.roundMembers.length?(this.roundMembers[0].namedScoresLine.length+this.qtyOfPlayers)%this.qtyOfPlayers:0;this.roundMembers.forEach((o,s)=>{s===n&&(this.activeRoundMemberId=o._id),this.scores[o._id]={name:"score",value:null,disabled:[],doubleZero:!1,barrel:0},o.namedScoresLine.length>1&&0===o.namedScoresLine[o.namedScoresLine.length-1].value&&0===o.namedScoresLine[o.namedScoresLine.length-2].value&&(this.scores[o._id].doubleZero=!0);let i=0;o.namedScoresLine.map(m=>{i=m.value+i,i>=900&&i<1e3?this.scores[o._id].barrel+=1:this.scores[o._id].barrel=0}),o.namedScoresLine.find(m=>"r"===m.name)&&this.scores[o._id].disabled.push("r"),o.namedScoresLine.find(m=>"s"===m.name)&&this.scores[o._id].disabled.push("s")}),this.initialScores=JSON.parse(JSON.stringify(this.scores))}checkOnTrippleZero(){Object.keys(this.scores).forEach(n=>{this.scores[n].barrel>0||this.scores[n].doubleZero&&0===this.scores[n].value&&(this.scores[n].value=-100)})}checkOnBarrelTimes(){Object.keys(this.scores).forEach(n=>{if(this.scores[n].barrel>=this.qtyOfPlayers||this.scores[n].barrel>=3){let o=0;this.roundMembers.find(s=>s._id===n).namedScoresLine.map(s=>{o=s.value+o}),o+this.scores[n].value<1e3&&(this.scores[n].value=this.customRoundNumber(o)-100-o)}})}checkOnFinishGame(){let n=!1;return Object.keys(this.scores).forEach(o=>{let s=0;this.roundMembers.find(i=>i._id===o).namedScoresLine.map(i=>{s=i.value+s}),s>=1e3&&(n=!0)}),n}checkGetOnBarrelOrWin(){Object.keys(this.scores).forEach(n=>{let o=0;this.roundMembers.find(s=>s._id===n).namedScoresLine.map(s=>{o=s.value+o}),o+=this.scores[n].value,o>900&&o<1e3&&!this.scores[n].barrel&&(this.scores[n].value=this.scores[n].value-(o-900)),o>=1e3&&(this.scores[n].value=this.scores[n].value-(o-1e3))})}checkOnValueIsNumber(){Object.keys(this.scores).forEach(n=>{"number"!=typeof this.scores[n].value&&(this.scores[n].value=0)})}checkOnRoundedValue(){Object.keys(this.scores).forEach(n=>{this.scores[n].barrel||(this.scores[n].value=this.customRoundNumber(this.scores[n].value))})}storeRoundScores(){this.checkOnValueIsNumber(),this.checkOnTrippleZero(),this.checkOnBarrelTimes(),this.checkGetOnBarrelOrWin(),this.checkOnRoundedValue(),this.gamesService.storeRoundScores(this.scores)}customRoundNumber(n){const o=Math.floor(n);return o%10<=5?10*Math.floor(o/10):10*Math.ceil(o/10)}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(e.zs3))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-round-thousand"]],features:[e._Bn([{provide:g,useExisting:t}]),e.qOj],decls:12,vars:9,consts:[[1,"round","round_result"],["size","12"],["expand","block",3,"click"],[3,"size",4,"ngFor","ngForOf"],[3,"size"],[3,"ngClass"],[1,"round-btn-block"],["size","small","color","secondary",1,"round-btn-block__item",3,"fill","disabled","click"],[1,"thousand-score-input"],["type","number","placeholder","0",3,"ngModel","ngModelChange"],["class","thousand-score__wrapper",3,"lines",4,"ngFor","ngForOf"],[1,"thousand-score__wrapper",3,"lines"],[1,"thousand-score__current",3,"color"],[2,"width","100%"],[1,"thousand-score__total",3,"ngClass","color"]],template:function(n,o){1&n&&(e.TgZ(0,"ion-card-content"),e.ynx(1,0),e.TgZ(2,"ion-row"),e.TgZ(3,"ion-col",1),e.TgZ(4,"ion-button",2),e.NdJ("click",function(){return o.storeRoundScores()}),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.qZA(),e.YNc(7,Ze,9,9,"ion-col",3),e.ALo(8,"async"),e.qZA(),e.TgZ(9,"ion-row"),e.YNc(10,Ce,2,2,"ion-col",3),e.ALo(11,"async"),e.qZA(),e.BQk(),e.qZA()),2&n&&(e.xp6(5),e.hij(" ",e.lcZ(6,3,"elements.button.submit")," "),e.xp6(2),e.Q6J("ngForOf",e.lcZ(8,5,o.roundMembers$)),e.xp6(3),e.Q6J("ngForOf",o.addTotals(e.lcZ(11,7,o.roundMembers$))))},directives:[r.FN,r.Nd,r.wI,r.YG,l.sg,l.mk,r.Ie,r.pK,r.as,h.JJ,h.On,r.yW],pipes:[_.X$,l.Ov],styles:[""]}),t})();function Ae(t,c){1&t&&e._UZ(0,"app-choose-players")}function be(t,c){if(1&t&&(e._UZ(0,"app-round-routes",6),e.ALo(1,"async"),e.ALo(2,"async")),2&t){const n=e.oxw(3);e.Q6J("roundId",e.lcZ(1,2,n.activeRoundId$))("playerId",e.lcZ(2,4,n.activePlayerId$))}}function Se(t,c){if(1&t&&(e._UZ(0,"app-round-length",6),e.ALo(1,"async"),e.ALo(2,"async")),2&t){const n=e.oxw(3);e.Q6J("roundId",e.lcZ(1,2,n.activeRoundId$))("playerId",e.lcZ(2,4,n.activePlayerId$))}}function Ie(t,c){if(1&t&&(e._UZ(0,"app-round-stations",6),e.ALo(1,"async"),e.ALo(2,"async")),2&t){const n=e.oxw(3);e.Q6J("roundId",e.lcZ(1,2,n.activeRoundId$))("playerId",e.lcZ(2,4,n.activePlayerId$))}}function qe(t,c){if(1&t&&(e._UZ(0,"app-round-cars",6),e.ALo(1,"async"),e.ALo(2,"async")),2&t){const n=e.oxw(3);e.Q6J("roundId",e.lcZ(1,2,n.activeRoundId$))("playerId",e.lcZ(2,4,n.activePlayerId$))}}function Re(t,c){if(1&t&&(e.TgZ(0,"app-round-wrapper",4),e.ALo(1,"async"),e.ALo(2,"async"),e.ALo(3,"async"),e.YNc(4,be,3,6,"app-round-routes",5),e.YNc(5,Se,3,6,"app-round-length",5),e.YNc(6,Ie,3,6,"app-round-stations",5),e.YNc(7,qe,3,6,"app-round-cars",5),e.qZA()),2&t){const n=e.oxw(2);e.Q6J("ngSwitch",e.lcZ(1,7,n.activeRoundId$))("roundId",e.lcZ(2,9,n.activeRoundId$))("playerId",e.lcZ(3,11,n.activePlayerId$)),e.xp6(4),e.Q6J("ngSwitchCase","routes"),e.xp6(1),e.Q6J("ngSwitchCase","length"),e.xp6(1),e.Q6J("ngSwitchCase","stations"),e.xp6(1),e.Q6J("ngSwitchCase","cars")}}function Oe(t,c){if(1&t&&(e.TgZ(0,"app-round-wrapper",6),e.ALo(1,"async"),e.ALo(2,"async"),e._UZ(3,"app-round-uno",6),e.ALo(4,"async"),e.ALo(5,"async"),e.qZA()),2&t){const n=e.oxw(2);e.Q6J("roundId",e.lcZ(1,4,n.activeRoundId$))("playerId",e.lcZ(2,6,n.activePlayerId$)),e.xp6(3),e.Q6J("roundId",e.lcZ(4,8,n.activeRoundId$))("playerId",e.lcZ(5,10,n.activePlayerId$))}}function Pe(t,c){if(1&t&&(e.TgZ(0,"app-round-wrapper",6),e.ALo(1,"async"),e.ALo(2,"async"),e._UZ(3,"app-round-rummy",6),e.ALo(4,"async"),e.ALo(5,"async"),e.qZA()),2&t){const n=e.oxw(2);e.Q6J("roundId",e.lcZ(1,4,n.activeRoundId$))("playerId",e.lcZ(2,6,n.activePlayerId$)),e.xp6(3),e.Q6J("roundId",e.lcZ(4,8,n.activeRoundId$))("playerId",e.lcZ(5,10,n.activePlayerId$))}}function Le(t,c){if(1&t&&(e.TgZ(0,"app-round-t-wrapper",6),e.ALo(1,"async"),e.ALo(2,"async"),e._UZ(3,"app-round-thousand",6),e.ALo(4,"async"),e.ALo(5,"async"),e.qZA()),2&t){const n=e.oxw(2);e.Q6J("roundId",e.lcZ(1,4,n.activeRoundId$))("playerId",e.lcZ(2,6,n.activePlayerId$)),e.xp6(3),e.Q6J("roundId",e.lcZ(4,8,n.activeRoundId$))("playerId",e.lcZ(5,10,n.activePlayerId$))}}function $e(t,c){if(1&t&&(e.YNc(0,Re,8,13,"app-round-wrapper",2),e.ALo(1,"async"),e.YNc(2,Oe,6,12,"app-round-wrapper",3),e.ALo(3,"async"),e.YNc(4,Pe,6,12,"app-round-wrapper",3),e.ALo(5,"async"),e.YNc(6,Le,6,12,"app-round-t-wrapper",3),e.ALo(7,"async")),2&t){const n=e.oxw();e.Q6J("ngIf","train"===e.lcZ(1,4,n.gameType$)),e.xp6(2),e.Q6J("ngIf","uno"===e.lcZ(3,6,n.gameType$)),e.xp6(2),e.Q6J("ngIf","rummy"===e.lcZ(5,8,n.gameType$)),e.xp6(2),e.Q6J("ngIf","thousand"===e.lcZ(7,10,n.gameType$))}}let Ne=(()=>{class t{constructor(n){this.store=n}ngOnInit(){this.rounds$=this.store.select(S.PK)}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(f.yh))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-round"]],inputs:{activeRoundId$:"activeRoundId$",activePlayerId$:"activePlayerId$",gameType$:"gameType$",players$:"players$"},decls:5,vars:6,consts:[[4,"ngIf","ngIfElse"],["restRounds",""],[3,"ngSwitch","roundId","playerId",4,"ngIf"],[3,"roundId","playerId",4,"ngIf"],[3,"ngSwitch","roundId","playerId"],[3,"roundId","playerId",4,"ngSwitchCase"],[3,"roundId","playerId"]],template:function(n,o){if(1&n&&(e.YNc(0,Ae,1,0,"app-choose-players",0),e.ALo(1,"async"),e.ALo(2,"async"),e.YNc(3,$e,8,12,"ng-template",null,1,e.W1O)),2&n){const s=e.MAs(4);e.Q6J("ngIf","start"===e.lcZ(1,2,o.activeRoundId$)&&0===e.lcZ(2,4,o.rounds$).length)("ngIfElse",s)}},directives:[l.O5,B,D,l.RF,l.n9,oe,te,se,ie,le,pe,he,xe],pipes:[l.Ov],styles:[""]}),t})();function we(t,c){if(1&t&&(e.TgZ(0,"ion-segment-button",8),e.ALo(1,"async"),e.ALo(2,"async"),e._UZ(3,"ion-icon",9),e.qZA()),2&t){const n=c.$implicit,o=e.oxw(2);e.Q6J("value",n._id)("disabled","start"===n._id&&e.lcZ(1,3,o.rounds$).length||"start"!==n._id&&0===e.lcZ(2,5,o.rounds$).length),e.xp6(3),e.Q6J("name",n.icon)}}function Je(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"ion-segment",6),e.NdJ("ionChange",function(s){return e.CHM(n),e.oxw().onMenuClickHandler(s)}),e.ALo(1,"async"),e.YNc(2,we,4,7,"ion-segment-button",7),e.qZA()}if(2&t){const n=e.oxw();e.Q6J("value",e.lcZ(1,2,n.activeRoundId$)),e.xp6(2),e.Q6J("ngForOf",n.roundsCfg)}}const Fe=function(t){return{"active-player":t}},Me=function(t){return{"border-left":t,"padding-left":"10px"}},Qe=function(t){return{"border-right":t,"padding-right":"10px"}};function ke(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"ion-item",16),e.NdJ("click",function(){const i=e.CHM(n).$implicit;return e.oxw(2).selectPlayer(i._id)}),e.ALo(1,"async"),e.TgZ(2,"ion-label",17),e._uU(3),e.qZA(),e.TgZ(4,"div",18),e._uU(5),e.qZA(),e.qZA()}if(2&t){const n=c.$implicit,o=e.oxw(2);e.Q6J("ngClass",e.VKq(7,Fe,n._id===e.lcZ(1,5,o.activePlayerId$)&&"thousand"!==o.gameType)),e.xp6(2),e.Q6J("ngStyle",e.VKq(9,Me,"6px solid "+n.color)),e.xp6(1),e.hij(" ",n.name," "),e.xp6(1),e.Q6J("ngStyle",e.VKq(11,Qe,"6px solid "+n.color)),e.xp6(1),e.hij(" ",o.getPlayerTotalScores(n._id)," ")}}function Ge(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"ion-button",14),e.NdJ("click",function(){return e.CHM(n),e.oxw(2).onFinishGameHandler()}),e.ALo(1,"async"),e.ALo(2,"async"),e._uU(3),e.ALo(4,"translate"),e.qZA()}if(2&t){const n=e.oxw(2);e.Q6J("disabled",0===e.lcZ(1,2,n.rounds$).length||e.lcZ(2,4,n.loading$)||"rummy"===n.gameType&&n.finishGameDisabled(n.playersWithTotal)),e.xp6(3),e.hij(" ",e.lcZ(4,6,"elements.button.finishGame")," ")}}function Ue(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"ion-button",19),e.NdJ("click",function(){return e.CHM(n),e.oxw(2).openNextRound()}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"elements.button.nextRound")," "))}function Ye(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"ion-card"),e.TgZ(1,"ion-card-header"),e.TgZ(2,"ion-card-title",10),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.qZA(),e.TgZ(5,"ion-card-content"),e.TgZ(6,"ion-list"),e.YNc(7,ke,6,13,"ion-item",11),e.qZA(),e.TgZ(8,"ion-row",12),e.YNc(9,Ge,5,8,"ion-button",13),e.TgZ(10,"ion-button",14),e.NdJ("click",function(){return e.CHM(n),e.oxw().onCancelGameHandler()}),e.ALo(11,"async"),e.ALo(12,"async"),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.YNc(15,Ue,3,3,"ion-button",15),e.qZA(),e.qZA(),e.qZA()}if(2&t){const n=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,6,"games."+n.gameType+".title")),e.xp6(4),e.Q6J("ngForOf",n.playersWithTotal),e.xp6(2),e.Q6J("ngIf","thousand"!==n.gameType),e.xp6(1),e.Q6J("disabled",0===e.lcZ(11,8,n.rounds$).length||e.lcZ(12,10,n.loading$)),e.xp6(3),e.hij(" ",e.lcZ(14,12,"elements.button.cancelGame")," "),e.xp6(2),e.Q6J("ngIf","uno"===n.gameType)}}function je(t,c){if(1&t&&(e.TgZ(0,"ion-row"),e.TgZ(1,"ion-col",20),e._UZ(2,"app-round",21),e.qZA(),e.qZA()),2&t){const n=e.oxw();e.xp6(2),e.Q6J("activeRoundId$",n.activeRoundId$)("activePlayerId$",n.activePlayerId$)("gameType$",n.gameType$)("players$",n.players$)}}const Be=[{path:"",component:(()=>{class t{constructor(n,o,s){this.store=n,this.sharedService=o,this.route=s,this.environment=p.N,this.showToolbarMenu=!1,this.activeRoundId$=new P.t(1),this.activePlayerId$=new P.t(1)}ngOnInit(){this.loading$=this.store.select(y.NH),this.gameType$=this.store.select(y.Wn),this.rounds$=this.store.select(S.PK),(0,w.aj)([this.gameType$,this.rounds$]).subscribe(([n,o])=>{!n||(this.gameType=n,this.showToolbarMenu=p.N.games[n].showToolbarMenu,this.roundsCfg=p.N.games[n].rounds,"uno"===n&&(this.nextRound=this.roundsCfg[1]),this.rounds=o,this.roundsCfg&&this.activeRoundId$.next(o.length?"uno"===this.gameType?this.roundsCfg[1]._id+(1===o.length?this.roundsCfg[1].namePostfix:o.length):this.roundsCfg[1]._id:this.roundsCfg[0]._id))}),this.roundMembers$=this.store.select(q.uW),this.players$=this.store.select(I.y1),this.players$.subscribe(n=>{n.length&&this.activePlayerId$.next(n[0]._id)}),this.players$.pipe((0,J.w)(n=>(this.players=n,this.roundMembers$))).subscribe(n=>{this.roundMembers=n,this.playersWithTotal=this.players.map(o=>Object.assign(Object.assign({},o),{totalScore:this.getPlayerTotalScores(o._id)})).sort((o,s)=>s.totalScore-o.totalScore)}),this.activePlayerId$.subscribe(n=>this.activePlayerId=n),this.route.params.subscribe(n=>{})}finishGameDisabled(n){let o=0;return n.forEach(s=>{0===this.getPlayerTotalScores(s._id)&&o++}),1!==o}getPlayerTotalScores(n){return this.sharedService.getPlayerTotalScores(n)}onMenuClickHandler(n){this.activeRoundId$.next(n.target.value)}onFinishGameHandler(){this.store.dispatch(Z.M8())}onCancelGameHandler(){this.store.dispatch(Z.GJ())}openNextRound(){this.store.dispatch(Z.oL())}selectPlayer(n){"thousand"!==this.gameType&&this.activePlayerId$.next(n)}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(f.yh),e.Y36(v.F),e.Y36(b.gz))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-game"]],decls:15,vars:11,consts:[["slot","end"],["menu","games-menu"],["scrollable","",3,"value","ionChange",4,"ngIf"],[1,"ion-no-margin","ion-no-padding"],["size-lg","6","size-md","8","size-sm","10","offset-lg","3","offset-md","2","offset-sm","1"],[4,"ngIf"],["scrollable","",3,"value","ionChange"],[3,"value","disabled",4,"ngFor","ngForOf"],[3,"value","disabled"],[3,"name"],[1,"ion-text-center"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"ion-justify-content-around"],["fill","outline","size","small",3,"disabled","click",4,"ngIf"],["fill","outline","size","small",3,"disabled","click"],["fill","outline","size","small",3,"click",4,"ngIf"],[3,"ngClass","click"],[3,"ngStyle"],["slot","end",3,"ngStyle"],["fill","outline","size","small",3,"click"],["size-lg","8","size-md","10","size-sm","12","offset-lg","2","offset-md","1","offset-sm","0"],[3,"activeRoundId$","activePlayerId$","gameType$","players$"]],template:function(n,o){1&n&&(e.TgZ(0,"ion-header"),e.TgZ(1,"ion-toolbar"),e.TgZ(2,"ion-buttons",0),e._UZ(3,"ion-menu-button",1),e.qZA(),e.YNc(4,Je,3,4,"ion-segment",2),e.qZA(),e.qZA(),e.TgZ(5,"ion-content"),e.TgZ(6,"ion-grid",3),e.TgZ(7,"ion-row"),e.TgZ(8,"ion-col",4),e.YNc(9,Ye,16,14,"ion-card",5),e.ALo(10,"async"),e.qZA(),e.qZA(),e.YNc(11,je,3,4,"ion-row",5),e.ALo(12,"async"),e.ALo(13,"async"),e.ALo(14,"async"),e.qZA(),e.qZA()),2&n&&(e.xp6(4),e.Q6J("ngIf",o.showToolbarMenu),e.xp6(5),e.Q6J("ngIf",0!==e.lcZ(10,3,o.rounds$).length),e.xp6(2),e.Q6J("ngIf","start"===e.lcZ(12,5,o.activeRoundId$)||e.lcZ(13,7,o.activeRoundId$)&&e.lcZ(14,9,o.activePlayerId$)))},directives:[r.Gu,r.sr,r.Sm,r.fG,l.O5,r.W2,r.jY,r.Nd,r.wI,r.cJ,r.QI,l.sg,r.GO,r.gu,r.PM,r.Zi,r.Dq,r.FN,r.q_,r.YG,r.Ie,l.mk,r.Q$,l.PC,Ne],pipes:[l.Ov,_.X$],styles:[""]}),t})()}];let He=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[b.Bz.forChild(Be)],b.Bz]}),t})(),N=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[h.u5,l.ez,r.Pc,_.aw.forChild({extend:!0})]]}),t})(),ze=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[l.ez,h.u5,r.Pc,_.aw.forChild({extend:!0}),N]]}),t})(),Ee=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[l.ez,h.u5,r.Pc,He,_.aw.forChild({extend:!0}),ze,N]]}),t})()}}]);